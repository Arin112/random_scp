<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Random SCP Portal</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: [
                "Rubik",
                "system-ui",
                "-apple-system",
                "BlinkMacSystemFont",
                "Segoe UI",
                "sans-serif",
              ],
            },
            colors: {
              "scp-iris": {
                50: "#f4f5ff",
                100: "#e8ebff",
                200: "#cfd5ff",
                300: "#a8b2ff",
                400: "#7b85ff",
                500: "#5b63ff",
                600: "#3f40ff",
                700: "#302ef4",
                800: "#1f1fd4",
                900: "#181aa9",
              },
            },
            boxShadow: {
              aurora: "0 25px 60px rgba(15, 23, 42, 0.45)",
            },
          },
        },
        darkMode: "class",
      };
    </script>
  </head>
  <body
    class="min-h-screen relative flex items-center justify-center bg-slate-950 text-slate-100 antialiased px-4 py-10"
    style="background-image: url('background.jpg'); background-size: cover; background-position: center; background-attachment: fixed;"
  >
    <div
      class="absolute inset-0 bg-gradient-to-br from-slate-950/90 via-indigo-950/75 to-slate-950/80 backdrop-blur-sm"
    ></div>
    <main class="relative z-10 w-full max-w-2xl">
      <header class="space-y-3 text-center">
        <span
          class="inline-flex items-center rounded-full border border-white/20 bg-white/10 px-3 py-1 text-xs font-semibold uppercase tracking-[0.3em] text-indigo-100"
          >SCP NAVIGATOR</span
        >
        <h1 class="text-3xl font-semibold sm:text-4xl">Random SCP Portal</h1>
        <p class="mx-auto max-w-xl text-base text-indigo-100/80 sm:text-lg">
          Выберите диапазон номеров и исследуйте случайные объекты Фонда SCP в
          русской или английской версии.
        </p>
      </header>
      <section
        class="mt-8 rounded-3xl border border-white/10 bg-white/10 p-8 shadow-aurora backdrop-blur-md sm:p-10"
      >
        <div class="grid gap-6">
          <div class="grid gap-4 sm:grid-cols-2">
            <label class="space-y-2 text-xs font-semibold uppercase tracking-[0.2em] text-indigo-100/80">
              Начало диапазона
              <input
                id="range-start"
                type="number"
                inputmode="numeric"
                placeholder="1"
                value="1"
                min="1"
                class="w-full rounded-2xl border border-white/20 bg-slate-950/60 px-4 py-4 text-base text-slate-100 shadow-inner shadow-black/10 transition focus:border-scp-iris-400 focus:outline-none focus:ring-4 focus:ring-scp-iris-500/30"
              />
            </label>
            <label class="space-y-2 text-xs font-semibold uppercase tracking-[0.2em] text-indigo-100/80">
              Конец диапазона
              <input
                id="range-end"
                type="number"
                inputmode="numeric"
                placeholder="4000"
                value="4000"
                min="1"
                class="w-full rounded-2xl border border-white/20 bg-slate-950/60 px-4 py-4 text-base text-slate-100 shadow-inner shadow-black/10 transition focus:border-scp-iris-400 focus:outline-none focus:ring-4 focus:ring-scp-iris-500/30"
              />
            </label>
          </div>
          <div class="grid gap-3 text-sm text-indigo-100/70">
            <p>
              Запрошенная страница может не существовать.
            </p>
          </div>
          <div class="grid gap-4 sm:grid-cols-2">
            <button
              type="button"
              id="open-ru"
              class="group relative overflow-hidden rounded-2xl px-6 py-4 font-semibold uppercase tracking-[0.25em] text-sm text-white transition hover:shadow-aurora focus:outline-none focus-visible:ring-4 focus-visible:ring-white/60"
            >
              <span
                class="absolute inset-0 bg-gradient-to-r from-scp-iris-600 via-scp-iris-500 to-scp-iris-400 opacity-90 transition duration-300 group-hover:opacity-100"
              ></span>
              <span class="relative flex items-center justify-center gap-2">
                <span class="hidden sm:inline text-xs tracking-[0.35em]"
                  >RU</span
                >
                <span class="text-sm font-medium tracking-[0.2em]"
                  >Открыть [RU]</span
                >
              </span>
            </button>
            <button
              type="button"
              id="open-en"
              class="group relative overflow-hidden rounded-2xl px-6 py-4 font-semibold uppercase tracking-[0.25em] text-sm text-white transition hover:shadow-aurora focus:outline-none focus-visible:ring-4 focus-visible:ring-white/60"
            >
              <span
                class="absolute inset-0 bg-gradient-to-r from-teal-500 via-cyan-500 to-blue-500 opacity-90 transition duration-300 group-hover:opacity-100"
              ></span>
              <span class="relative flex items-center justify-center gap-2">
                <span class="hidden sm:inline text-xs tracking-[0.35em]"
                  >EN</span
                >
                <span class="text-sm font-medium tracking-[0.2em]"
                  >Открыть [EN]</span
                >
              </span>
            </button>
          </div>
          <p
            id="feedback"
            role="status"
            aria-live="polite"
            class="min-h-[1.25rem] text-sm text-indigo-100/70"
          ></p>
        </div>
      </section>
    </main>
    <script>
      const startInput = document.querySelector("#range-start");
      const endInput = document.querySelector("#range-end");
      const ruButton = document.querySelector("#open-ru");
      const enButton = document.querySelector("#open-en");
      const feedback = document.querySelector("#feedback");

      const ROUTES = {
        ru: "https://scpfoundation.net/scp-",
        en: "https://scp-wiki.wikidot.com/scp-",
      };

      const clampRange = (value) => {
        const max = 9999;
        if (Number.isNaN(value)) return null;
        return Math.min(Math.max(value, 1), max);
      };

      const formatId = (value) => {
        if (value < 100) {
          return value.toString().padStart(3, "0");
        }
        return value.toString();
      };

      const setFeedback = (
        message,
        { isError = false, url = null, anchorText = "" } = {}
      ) => {
        feedback.dataset.state = isError ? "error" : "idle";
        feedback.classList.toggle("text-rose-300", isError);

        if (isError || !url) {
          feedback.textContent = message;
          if (!isError) {
            feedback.classList.remove("text-rose-300");
          }
          return;
        }

        feedback.classList.remove("text-rose-300");
        const link = document.createElement("a");
        link.href = url;
        link.target = "_blank";
        link.rel = "noopener";
        link.className =
          "underline decoration-dashed decoration-2 underline-offset-4 text-indigo-100 hover:text-white transition";
        link.textContent = anchorText || url;

        feedback.textContent = message ? `${message} ` : "";
        feedback.appendChild(link);
      };

      const getRandomInRange = (min, max) => {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      };

      const handleOpen = (locale) => {
        const start = clampRange(parseInt(startInput.value, 10));
        const end = clampRange(parseInt(endInput.value, 10));

        if (start === null || end === null) {
          setFeedback("Введите корректные числа в оба поля.", { isError: true });
          return;
        }

        if (start > end) {
          setFeedback("Начало диапазона не может быть больше конца.", {
            isError: true,
          });
          return;
        }

        const randomId = getRandomInRange(start, end);
        const formattedId = formatId(randomId);
        const targetUrl = `${ROUTES[locale]}${formattedId}`;

        setFeedback("Последняя открытая страница", {
          url: targetUrl,
          anchorText: `SCP-${formattedId} [${locale.toUpperCase()}]`,
        });
        window.open(targetUrl, "_blank", "noopener");
      };

      ruButton.addEventListener("click", () => handleOpen("ru"));
      enButton.addEventListener("click", () => handleOpen("en"));

      [startInput, endInput].forEach((input) => {
        input.addEventListener("input", () => {
          if (feedback.dataset.state === "error") {
            setFeedback("");
          }
        });
      });
    </script>
  </body>
</html>
